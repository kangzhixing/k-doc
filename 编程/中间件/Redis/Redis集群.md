## Redis集群

### Redis回收进程如何工作的？

一个客户端运行了新的命令，添加了新的数据。

Redi检查内存使用情况，如果大于maxmemory的限制, 则根据设定好的策略进行回收。

### Redis回收使用的是什么算法？

LRU算法

### Redis有哪些适合的场景？

1) Session共享(单点登录)

1) 页面缓存

1) 队列

1) 排行榜/计数器

1) 发布/订阅

### Redis如何做内存优化？

尽可能使用散列表（hashes），散列表（是说散列表里面存储的数少）使用的内存非常小，所以你应该尽可能的将你的数据模型抽象到一个散列表里面。比如你的web系统中有一个用户对象，不要为这个用户的名称，姓氏，邮箱，密码设置单独的key,而是应该把这个用户的所有信息存储到一张散列表里面.

### Redis集群最大节点个数是多少？
Redis集群预分好16384个桶(哈希槽：2^14 = 16384)

## 脑裂问题

某个master所在节点突然脱离正常的网络，无法和其他slave机器连接，但实际上master还运行着

此时哨兵可能就会认为master宕机了，然后开启选举，将其他slave切换成了master

这个时候，集群里就会有两个master，也就是所谓的脑裂

此时虽然某个slave被切换成了master，但是可能client还没来得及切换到新的master，还继续写向旧master的数据可能也丢失了

因此旧master再次恢复时，会被作为一个slave挂到新的master上去，自己的数据会被清空，重新从新的master复制数据